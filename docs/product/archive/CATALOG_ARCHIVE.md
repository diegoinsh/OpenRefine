# OpenRefine 档案行业功能目录

## 一、产品概述

OpenRefine 是一款专为档案行业设计的数据处理工具，基于 Java 技术开发，采用 Web 浏览器作为操作界面。它能够帮助各级档案馆、档案室以及政府机关、企事业单位的档案部门完成数字化档案数据的整理、清洗、校验和管理工作。所有数据处理均在本地计算机完成，确保涉密档案数据的安全性和保密性，完全符合档案信息化的安全要求。

OpenRefine 针对档案业务场景开发了多个专业扩展模块，包括档案数据库导入扩展（Records-DB）、档案资源管理扩展（Records-Assets）和数据质量检查扩展（Data-Quality）。这些扩展模块针对档案行业的数据特点进行了专门设计，能够更好地满足档案元数据著录、资源文件管理、数据质量校验等业务需求。软件支持《档案著录规则》（DA/T 18）等国家行业标准，帮助档案工作者高效完成档案数字化整理工作。

**适用范围**：各级国家档案馆、机关档案室、企业档案部门、高校档案馆、事业单位档案部门、档案数字化加工服务机构

**适用场景**：档案数字化成果整理、档案数据库建设、档案移交接收、档案质量检查、档案资源整理

---

## 二、核心功能模块

### 2.1 档案数据导入

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 档案数据库连接 | 通过 JDBC 连接各类档案业务数据库（MySQL、PostgreSQL、SQLite 等） | 从现有档案数据库导出数据进行整理 |
| Schema Profile 配置 | 定义数据模型，支持预置档案数据模板（库宝、平表、通用 JSON） | 适配不同档案管理系统的数据结构 |
| 字段映射 | 可视化选择和映射数据库字段到著录项目 | 灵活配置导入的元数据字段 |
| 数据预览 | 导入前预览数据结构、前 100 行数据样例 | 确认数据解析正确性 |
| 过滤条件 | 配置数据过滤条件，支持多条件 AND/OR 组合 | 只导入符合条件的目标档案 |
| 项目创建 | 将导入数据创建为 OpenRefine 项目 | 便于后续的整理和校验工作 |
| 连接管理 | 保存和复用数据库连接配置 | 多次导入同一数据源时提高效率 |
| 编码识别 | 自动检测文件编码（UTF-8、GBK 等） | 正确处理历史数据文件 |

### 2.2 档案资源管理

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 目录浏览 | 以树形结构浏览档案资源目录 | 查看数字化成果的文件夹结构 |
| 文件预览 | 支持图片、PDF、Word、文本等多种格式预览 | 核对电子文件与元数据的一致性 |
| 分页显示 | 大目录分页浏览，避免卡顿 | 处理包含大量文件的档案目录 |
| 安全路径验证 | 防止目录遍历攻击，保障数据安全 | 确保只在授权范围内访问文件 |
| 路径配置 | 配置允许访问的资源根目录 | 限制资源访问范围，保障安全 |
| 文件搜索 | 按文件名快速定位资源 | 在大量文件中查找特定档案 |

### 2.3 数据资源绑定

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 文件路径映射 | 配置数据列到文件路径的映射规则 | 实现档号与电子文件的一一对应 |
| 多字段拼接 | 支持多个字段值拼接成完整路径 | 按档号规则自动构建文件路径 |
| 路径预览 | 预览映射后的文件路径是否正确 | 在导入前验证路径配置的正确性 |
| 资源导出 | 批量导出数据绑定的电子文件 | 整理数字化成果便于移交 |
| 复制/移动操作 | 选择复制或移动文件 | 按需整理资源文件结构 |
| 导出统计 | 显示成功、失败、跳过的文件数量 | 核对导出结果完整性 |
| 批量重命名 | 按规则批量重命名导出文件 | 规范化电子文件命名 |

### 2.4 档案数据质量检查

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 质量规则管理 | 创建、编辑、保存质量检查规则 | 建立馆藏数据的质量检查标准 |
| 格式检查 | 唯一性检查、非空检查、值域检查、日期格式检查 | 检查元数据著录是否符合规范 |
| 唯一性检查 | 检测档号、题名等关键字段是否重复 | 防止重复录入同一份档案 |
| 非空检查 | 检测必填字段是否为空 | 确保重要著录项目完整 |
| 日期格式检查 | 验证日期字段格式正确性 | 规范档案日期著录格式 |
| 正则匹配检查 | 使用正则表达式验证字段格式 | 检查档号、文号等字段格式规范 |
| 资源关联检查 | 验证电子文件存在性、数量一致性、命名规范 | 确保电子档案与目录一致 |
| 文件存在性检查 | 检查指定路径下是否存在对应文件 | 核对数字化成果完整性 |
| 文件数量检查 | 核对数据中页数与实际文件数量 | 检查扫描件是否齐全 |
| 命名规范检查 | 验证文件夹和文件名命名规范 | 规范数字化成果整理标准 |
| 序号连续性检查 | 检查文件夹和文件名序号是否连续 | 发现缺失的扫描件 |
| 内容比对检查 | 调用 OCR 服务抽取信息并与元数据比对 | 发现著录与原文不一致问题 |
| 规则模板 | 预置档案著录规则模板 | 快速应用行业标准规则 |
| 断点续跑 | 支持检查任务暂停和恢复 | 大批量数据检查时分批进行 |
| 结果展示 | 可视化展示检查结果（错误、警告、通过） | 快速定位需要修正的数据 |
| 结果导出 | 导出带标注 Excel、PDF 报告 | 生成质检报告存档或反馈 |

---

## 三、通用数据处理功能

### 3.1 数据清洗

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 列操作 | 添加、删除、重命名、移动、拆分、合并列 | 调整元数据结构以符合标准 |
| 行操作 | 基于条件过滤、删除、标记行 | 筛选需要整理的目标档案 |
| 单元格编辑 | 单个或批量修改单元格内容 | 修正著录错误 |
| 文本清理 | 去除首尾空白、统一空白字符 | 规范文本格式 |
| 大小写转换 | 转换英文文本大小写 | 规范外文题名、责任人著录 |
| HTML 标签去除 | 移除文本中的 HTML 标签 | 清理从网页导入的数据 |
| 替换功能 | 字符串替换和正则表达式替换 | 批量修正格式错误 |
| 拆分列 | 按分隔符或固定宽度拆分列 | 分解复合字段内容 |
| 合并列 | 合并多列内容为一列 | 组合多字段生成完整信息 |
| 填充功能 | 向下/向上填充空值单元格 | 补全缺失的重复信息 |

### 3.2 数据标准化

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 表达式语言 | 使用 GREL 进行数据转换 | 复杂的格式转换和标准化 |
| 数学运算 | 四则运算、幂运算、四舍五入 | 数值字段计算和修约 |
| 字符串操作 | 截取、查找、替换、大小写转换 | 文本字段标准化 |
| 日期处理 | 日期解析、格式化、差值计算 | 统一日期格式 |
| 条件判断 | if-else 条件逻辑处理 | 根据条件设置字段值 |
| 链式调用 | 多函数串联处理数据 | 组合多步标准化操作 |

### 3.3 分面与过滤

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 文本分面 | 按文本值统计分布并筛选 | 按档案类型、责任者等筛选 |
| 数值分面 | 按数值范围统计分布并筛选 | 按年度、数量等范围筛选 |
| 快速过滤 | 基于关键词快速过滤数据 | 快速定位特定档案 |
| 自定义分面 | 使用表达式自定义分面逻辑 | 按自定义规则分组统计 |
| 组合过滤 | 多个条件组合筛选 | 精确筛选目标档案 |
| 保存过滤 | 保存和加载过滤条件 | 复用常用的筛选条件 |

### 3.4 排序与去重

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 多列排序 | 按多列组合排序 | 按年度、档号等排序 |
| 去重 | 去除重复行 | 识别和处理重复档案 |
| 排序保持行完整性 | 排序时保持行数据完整 | 保持关联数据同步移动 |

---

## 四、数据导出功能

### 4.1 档案数据导出

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| CSV/TSV 导出 | 导出为逗号或制表符分隔文件 | 生成标准格式的档案目录 |
| Excel 导出 | 导出为 Excel 格式 | 生成便于查看的目录文档 |
| Excel 带格式 | 导出带标注的 Excel（含错误标记） | 生成质检反馈报告 |
| 自定义导出 | 通过模板自定义导出格式 | 符合特定系统的导入要求 |
| SQL 导出 | 导出为 SQL INSERT 语句 | 导入到档案数据库系统 |
| 编码选择 | 支持 UTF-8、GBK 等编码导出 | 确保文件在其他系统正常显示 |

### 4.2 资源文件导出

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 批量导出 | 按映射关系批量导出电子文件 | 整理数字化成果 |
| 路径配置 | 配置导出目标路径规则 | 按要求整理文件结构 |
| 进度显示 | 显示导出进度和统计信息 | 监控导出任务执行情况 |
| 错误报告 | 记录导出失败的错误原因 | 便于后续补录和处理 |

---

## 五、数据匹配与增强

### 5.1 实体匹配

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| Wikidata 匹配 | 匹配人物、地名、组织等到 Wikidata | 补充实体标准化信息 |
| 批量匹配 | 批量匹配单元格到已知实体 | 统一规范化的实体名称 |
| 匹配预览 | 预览匹配结果和置信度 | 审核匹配结果的准确性 |
| 手动选择 | 手动选择正确的匹配实体 | 处理低置信度的匹配结果 |

### 5.2 数据增强

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 获取外部数据 | 从网络获取关联信息补充数据 | 补充作者、机构等信息 |
| 维基数据增强 | 从 Wikidata 获取实体属性 | 统一规范化的实体信息 |
| 自定义列 | 基于表达式创建新列 | 计算派生字段、合并字段 |

---

## 六、档案专用扩展模块

### 6.1 Records-DB 扩展（档案数据库导入）

| 功能模块 | 功能描述 | 核心价值 |
|---------|----------|----------|
| 数据库连接 | 支持 MySQL、PostgreSQL、SQLite 等 | 兼容主流档案数据库 |
| 连接池管理 | 数据库连接池优化性能 | 提高大数据量导入效率 |
| Schema Profile | 数据模型配置，支持预置模板 | 适配各类档案数据结构 |
| 库宝模板 | 适配库宝档案管理系统 | 直接导入无需转换 |
| 平表模板 | 适配标准平表结构 | 符合档案目录交换标准 |
| 通用 JSON | 适配自定义 JSON 格式 | 灵活应对特殊需求 |
| 字段选择 | 可视化选择导入字段 | 精确控制导入内容 |
| 过滤构建器 | 可视化构建过滤条件 | 灵活筛选目标数据 |
| 项目绑定 | 配置保存到项目 | 保持导入配置的复用性 |
| 性能优化 | 流式处理、缓存机制 | 1000 行数据导入仅需 45ms |

### 6.2 Records-Assets 扩展（档案资源管理）

| 功能模块 | 功能描述 | 核心价值 |
|---------|----------|----------|
| 目录浏览 | 树形结构展示资源目录 | 直观了解资源组织结构 |
| 分页显示 | 大目录分页加载 | 处理海量资源不卡顿 |
| 图片预览 | 支持常见图片格式预览 | 核对扫描件内容 |
| PDF 预览 | 内嵌 PDF 阅读器预览 | 查看多页 PDF 文档 |
| Word 预览 | 提供文档下载 | 查看 Word 格式说明 |
| 安全验证 | 防止目录遍历攻击 | 保障档案数据安全 |
| 路径白名单 | 配置允许访问的根目录 | 限制操作范围 |

### 6.3 Data-Quality 扩展（数据质量检查）

| 功能模块 | 功能描述 | 核心价值 |
|---------|----------|----------|
| 规则编辑器 | 可视化编辑质量检查规则 | 无需编程即可配置规则 |
| 规则模板 | 预置档案著录规则 | 快速应用行业标准 |
| 著录规则 2022 | 《档案著录规则》DA/T 18-2022 | 对标最新国家标准 |
| 著录规则 1999 | 《档案著录规则》DA/T 18-1999 | 兼容历史数据标准 |
| 格式检查 | 多类型格式验证 | 全面检查元数据质量 |
| 资源检查 | 文件存在性、数量、规范性检查 | 确保电子档案完整性 |
| 内容比对 | OCR 抽取与元数据比对 | 发现著录与原文差异 |
| 断点续跑 | 任务暂停恢复机制 | 大批量数据分批检查 |
| 进度显示 | 实时显示检查进度 | 了解任务执行状态 |
| 结果标注 | 错误行标注 Excel 导出 | 便于反馈和修正 |
| 统计报告 | 生成检查统计报表 | 汇总分析数据质量 |

---

## 七、界面与操作功能

### 7.1 项目管理

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 项目列表 | 查看和管理所有档案项目 | 组织多个整理任务 |
| 项目导入/导出 | 导入导出 OpenRefine 项目文件 | 项目备份和迁移 |
| 项目重命名 | 修改项目名称 | 规范命名便于管理 |
| 项目删除 | 删除项目 | 清理已完成的任务 |

### 7.2 历史记录

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 操作历史 | 记录所有数据操作 | 追溯数据修改过程 |
| 撤销/重做 | 支持多步撤销和重做 | 修正误操作 |
| 历史注释 | 为操作添加说明 | 记录数据变更原因 |
| 历史导出 | 导出操作历史记录 | 归档数据处理日志 |

### 7.3 视图功能

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 记录视图 | 按档案记录模式查看 | 关联同一档案的多行数据 |
| 行视图 | 按传统表格模式查看 | 逐行编辑数据 |
| 跨记录编辑 | 在记录视图下跨行编辑 | 批量修改同类数据 |
| 列宽调整 | 拖动调整列宽 | 优化数据展示效果 |
| 固定列 | 锁定重要列不滚动 | 方便长表格浏览 |

---

## 八、系统功能

### 8.1 安全性

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 本地运行 | 所有处理在本地完成 | 保护涉密档案数据安全 |
| 路径验证 | 防止目录遍历攻击 | 防止越权访问文件 |
| 数据隔离 | 项目数据独立存储 | 防止数据混淆 |
| 无网络依赖 | 核心功能离线可用 | 满足内网环境使用 |

### 8.2 性能优化

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 流式处理 | 大数据集流式处理 | 轻松处理十万级档案条目 |
| 连接池 | 数据库连接复用 | 提高数据库导入效率 |
| 懒加载 | 大量数据懒加载展示 | 界面响应流畅 |
| 增量处理 | 大任务分批处理 | 避免内存溢出 |

### 8.3 国际化

| 功能名称 | 功能描述 | 档案应用场景 |
|---------|----------|-------------|
| 中文界面 | 完整中文界面 | 降低使用门槛 |
| 多语言支持 | 支持 40+ 语言 | 适应国际化需求 |
| 语言切换 | 动态切换界面语言 | 满足多语言工作环境 |

---

## 九、接口与扩展

### 9.1 后端 API

| 端点 | 方法 | 描述 | 扩展 |
|------|------|------|------|
| /command/records-db/initialize-ui | POST | 初始化档案数据库导入 UI | Records-DB |
| /command/records-db/parse-preview | POST | 预览档案数据 | Records-DB |
| /command/records-db/create-project | POST | 创建档案数据项目 | Records-DB |
| /command/records-assets/list | GET | 列出档案资源目录 | Records-Assets |
| /command/records-assets/preview | GET | 预览档案资源文件 | Records-Assets |
| /command/data-quality/save-rules | POST | 保存质量规则 | Data-Quality |
| /command/data-quality/run-check | POST | 运行质量检查 | Data-Quality |
| /command/data-quality/get-results | GET | 获取检查结果 | Data-Quality |
| /command/data-quality/export-excel | POST | 导出带标注 Excel | Data-Quality |

### 9.2 扩展开发

| 功能名称 | 功能描述 |
|---------|----------|
| 模块化架构 | 扩展模块与核心功能分离 |
| 标准接口 | 提供完善的扩展开发 API |
| 插件机制 | 支持动态加载扩展模块 |
| 配置管理 | 扩展配置与项目数据分离存储 |

---

## 十、技术规格

### 10.1 运行环境

| 项目 | 要求 |
|------|------|
| JDK | JDK 11 或更高版本 |
| 操作系统 | Windows 10+、macOS 10.15+、Linux |
| 内存 | 最小 2GB，推荐 4GB+ |
| 磁盘 | 根据数据量确定，建议 SSD |

### 10.2 支持的数据库

| 数据库 | 状态 | 档案应用 |
|--------|------|----------|
| MySQL | ✅ 支持 | 主流档案数据库 |
| PostgreSQL | ✅ 支持 | 大型档案信息系统 |
| MariaDB | ✅ 支持 | 替代 MySQL 选项 |
| SQLite | ✅ 支持 | 轻量级档案数据 |
| H2 | ✅ 测试用 | 开发测试环境 |

### 10.3 支持的文件格式

| 格式 | 导入 | 导出 | 档案应用 |
|------|------|------|----------|
| CSV | ✅ | ✅ | 档案目录交换 |
| Excel (.xlsx) | ✅ | ✅ | 档案目录查看 |
| JSON | ✅ | ✅ | 数据交换格式 |
| XML | ✅ | ✅ | 档案元数据交换 |
| 图片 | ✅ 预览 | - | 电子档案预览 |
| PDF | ✅ 预览 | - | 电子档案预览 |

---

## 十一、版本信息

| 版本 | 发布日期 | 主要变更 |
|------|----------|----------|
| 3.x | 2024+ | 新增档案专用扩展模块 |
| 2.x | 2018-2023 | 基础功能完善 |
| 1.x | 2013-2017 | Google Refine 时期 |

---

## 十二、档案业务流程集成

### 12.1 档案数字化整理流程

```
1. 数据导出 → 从档案业务系统导出元数据
          ↓
2. 数据导入 → 使用 Records-DB 导入到 OpenRefine
          ↓
3. 数据清洗 → 清洗著录错误、统一格式
          ↓
4. 质量检查 → 使用 Data-Quality 检查数据质量
          ↓
5. 修正问题 → 根据检查结果修正数据
          ↓
6. 资源核对 → 使用 Records-Assets 核对电子文件
          ↓
7. 数据导出 → 导出整理后的数据
          ↓
8. 成果整理 → 使用 Records-Assets 导出电子文件
```

### 12.2 档案移交接收流程

```
移交方：
1. 数据导出 → 导出待移交档案数据
2. 质量自检 → 使用 Data-Quality 进行预检
3. 问题修正 → 修正发现的质量问题
4. 提交移交 → 生成移交数据包

接收方：
1. 数据导入 → 导入移交数据
2. 质量抽检 → 使用 Data-Quality 抽样检查
3. 资源核对 → 使用 Records-Assets 核对电子文件
4. 问题反馈 → 导出质检报告反馈问题
5. 数据入库 → 验收合格后入库
```

---

*文档生成时间：2025年12月29日*
*产品名称：OpenRefine（档案行业版）*
*文档版本：1.0*
