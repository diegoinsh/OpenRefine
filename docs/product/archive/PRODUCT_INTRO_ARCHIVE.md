# OpenRefine 档案行业产品手册

## 一、产品概述

### 1.1 产品介绍

OpenRefine 是一款专为档案行业量身打造的数据处理平台，由 Java 技术开发，采用 Web 浏览器作为操作界面。它专门针对各级档案馆、机关档案室、企业档案部门以及档案数字化加工服务机构的业务需求进行了深度优化，能够帮助档案工作者高效完成数字化档案数据的整理、清洗、校验和管理工作。与传统档案软件不同，OpenRefine 采用开放式架构设计，既可以作为独立的档案数据整理工具使用，也可以与现有的档案管理信息系统无缝集成，形成完整的档案信息化解决方案。

OpenRefine 的核心优势在于其对档案业务场景的深度理解和对数据安全的严格把控。针对档案行业的特殊需求，开发团队专门设计并实现了三个核心扩展模块：档案数据库导入扩展（Records-DB）专门解决从各类档案业务系统导出数据的整理问题，支持多种数据库类型和预置的档案数据结构模板；档案资源管理扩展（Records-Assets）专门解决电子档案文件与元数据关联管理的问题，支持目录浏览、文件预览和批量导出等功能；数据质量检查扩展（Data-Quality）专门解决档案元数据质量控制问题，支持格式检查、资源关联检查和内容比对检查等多种检查类型，帮助档案工作者建立规范化的质量控制体系。

所有数据处理操作均在用户本地计算机上完成，涉密档案数据不需要上传到任何服务器或云端，从根本上保障了档案信息的安全性和保密性。这一特性使得 OpenRefine 完全符合国家档案局关于档案信息安全的相关规定，能够安全地应用于涉密档案数据的整理工作。同时，软件支持无限次的撤销和重做操作，每一步数据变更都被完整记录在操作历史中，既方便工作过程中的差错纠正，也满足了档案工作可追溯性的管理要求。

### 1.2 产品定位

OpenRefine 定位为档案数字化整理与质量控制的专业工具，主要服务于以下业务场景：在档案数字化成果整理方面，软件能够帮助档案馆对数字化扫描产生的元数据进行规范化整理，统一数据格式，修正著录错误，核对电子文件与目录的一致性；在档案数据库建设方面，软件支持从现有业务系统导出数据，经过清洗转换后导入新的档案数据库，支持不同系统间的数据迁移和格式转换；在档案移交接收方面，软件提供的质量检查功能能够帮助移交方和接收方建立统一的质检标准，确保移交数据的完整性和准确性；在档案质量核查方面，软件能够对馆藏档案数据进行定期的质量抽查，发现格式错误、缺失字段、资源关联问题等质量隐患。

作为档案信息化的辅助工具，OpenRefine 填补了传统档案管理信息系统在数据清洗和质量控制方面的功能空白。档案管理信息系统通常专注于档案的收集、保管和利用等核心业务功能，对于大量历史数据的整理清洗、质量校验等预处理工作支持不足。OpenRefine 正好弥补了这一短板，它独立于具体的档案管理信息系统，可以与任何支持标准数据格式导入的系统配合使用。这种开放式的设计理念使得档案工作者能够根据实际需要灵活选择和组合各种工具，构建最适合本单位需求的信息化工作流程。

### 1.3 核心价值

OpenRefine 为档案行业用户带来了四个方面的核心价值。第一是数据安全保障，所有数据处理都在本地完成，不需要将敏感档案信息上传到云端或外部服务器，这对于处理涉密档案、具有保密要求的内部档案以及个人隐私档案尤为重要，完全符合档案信息保密管理的要求。第二是工作效率提升，批量处理和自动化功能使得原本需要人工逐条检查修正的工作可以快速完成，根据实际应用统计，熟练使用 OpenRefine 后，档案元数据的整理效率可以提升数倍甚至数十倍。第三是质量控制规范化，软件内置的档案著录规则模板和数据质量检查功能，帮助档案工作者建立统一的质量标准和检查流程，使质量控制工作从人工抽查转变为系统自动校验，大幅提升了质检的覆盖率和一致性。第四是操作过程可追溯，每一步数据操作都被记录在历史记录中，可以随时查看和回溯，满足档案工作对数据处理过程可追溯性的管理要求。

## 二、核心功能详解

### 2.1 档案数据导入功能

档案数据的规范化导入是档案整理工作的起点。OpenRefine 的档案数据库导入功能专门针对档案行业的数据特点进行了优化设计，能够处理从各类档案业务系统导出的数据。软件通过 JDBC 标准接口连接数据库，支持 MySQL、PostgreSQL、SQLite 等主流数据库类型，几乎可以兼容目前市场上所有的档案管理信息系统。在连接配置方面，软件支持保存常用的连接配置，方便用户反复使用同一数据源，避免每次都重新输入连接参数的繁琐操作。

Schema Profile 配置是档案数据导入的核心功能。档案行业存在多种不同的数据结构和著录标准，不同的档案管理系统采用的数据模型也各不相同。OpenRefine 引入 Schema Profile 的概念，允许用户根据实际数据情况定义数据模型结构。软件预置了三种常用的档案数据模板：库宝模板适配库宝档案管理系统的数据结构，能够直接导入该系统的导出数据；平表模板符合档案目录交换标准的数据结构，适合处理符合国家档案局数据规范的档案目录；通用 JSON 模板支持自定义的 JSON 格式数据，可以灵活应对各种非标准的数据结构。这种多模板支持的设计使得 OpenRefine 能够适应不同用户的数据环境，不需要进行复杂的数据格式转换就可以直接导入数据。

字段映射功能让用户能够灵活控制导入的数据内容。在导入过程中，用户可以预览数据结构，选择需要导入的字段，排除不需要的字段，调整字段的顺序和名称。对于需要将多个源字段合并为一个目标字段，或者将一个源字段拆分为多个目标字段的情况，软件提供了强大的表达式支持，用户可以通过编写简单的表达式实现复杂的字段转换。过滤条件的配置则允许用户在数据导入阶段就进行初步筛选，只导入符合特定条件的档案记录，减少后续处理的工作量。

### 2.2 档案资源管理功能

电子档案与目录数据的关联管理是档案数字化工作的重要环节。OpenRefine 的档案资源管理功能提供了完善的电子文件浏览和预览能力，帮助档案工作者核对电子文件与元数据的一致性。目录浏览功能以树形结构展示档案资源的文件夹组织方式，用户可以直观地了解数字化成果的目录结构，快速定位到需要查看的文件夹。对于包含大量文件的大型目录，软件采用分页加载的方式，避免一次性加载过多文件导致的性能问题，确保界面操作流畅响应。

文件预览功能支持多种常见的电子档案格式。图片类型的电子档案（如 TIFF、JPEG、PNG 等扫描件格式）可以直接在浏览器中查看，无需额外的查看软件。PDF 文档采用内嵌的 PDF 阅读器进行预览，可以方便地翻页查看多页文档的内容。Word 文档提供下载链接，用户可以下载到本地查看。对于文本类型的文件，内容直接显示在浏览器中。这种多格式的预览支持使得档案工作者可以在同一个软件中完成元数据查看和电子档案核对的全部工作，不需要在多个软件之间切换，大幅提升了工作效率。

安全机制是资源管理功能的重要组成部分。档案数据通常具有一定的保密要求，资源管理功能必须确保只有经过授权的用户才能访问特定的电子文件。OpenRefine 实现了严格的路径验证机制，防止目录遍历攻击。用户需要预先配置允许访问的根目录，软件会检查所有的文件访问请求，确保访问范围不超出授权目录。这种白名单机制从技术上保障了档案数据的安全，防止误操作或恶意访问导致的档案信息泄露。

### 2.3 数据质量检查功能

数据质量是档案工作的生命线。OpenRefine 的数据质量检查功能是面向档案行业最重要的扩展模块之一，它提供了一整套完整的数据质量控制解决方案，帮助档案工作者建立规范化的质量检查流程。功能的设计充分考虑了档案行业的业务特点，检查规则符合《档案著录规则》（DA/T 18）等国家行业标准的要求，检查类型覆盖了档案元数据著录的各个方面。

格式检查是质量检查的基础功能，包括唯一性检查、非空检查、值域检查、日期格式检查和正则匹配检查五种类型。唯一性检查用于验证档号、题名等关键字段是否存在重复值，这是档案目录管理的基本要求。非空检查用于验证必填字段是否填写完整，确保重要的著录信息不遗漏。值域检查用于验证字段值是否在允许的范围内，例如年度字段应该在合理的历史范围内。日期格式检查用于验证日期字段的著录格式是否符合规范，支持用户自定义日期格式。正则匹配检查是最灵活的检查方式，用户可以通过编写正则表达式定义任意的格式验证规则，适用于档号、文号等有特定格式要求的字段。

资源关联检查是质量检查功能针对档案行业的特色设计。档案数字化工作不仅需要整理元数据，还需要确保电子文件与目录数据的一致性。资源关联检查提供了五种检查项目：文件存在性检查验证指定路径下是否存在对应的电子文件；文件数量检查核对数据中记录的页数与实际文件数量是否一致；文件夹命名规范检查验证文件夹名称是否符合本单位的命名规则；文件夹序号连续性检查发现缺失的文件夹；文件序号连续性检查发现缺失的扫描件。这五种检查项目涵盖了档案数字化成果完整性的各个方面，能够全面发现电子档案与目录数据之间的不一致问题。

内容比对检查是质量检查功能的高级特性，它通过集成 OCR 信息抽取服务，从电子档案文件中提取关键信息，然后将提取结果与数据库中的元数据进行比对。这种检查方式能够发现元数据著录与原始文件内容之间的不一致，帮助用户发现潜在的著录错误。例如，检查人员可以通过内容比对发现题名中的错别字、责任者的笔误、文号的记载错误等问题。系统支持自定义相似度阈值，当提取结果与元数据的相似度低于阈值时会产生警告，用户可以人工复核确认。

质量规则的配置采用可视化的界面设计，用户不需要编写代码就可以完成复杂的规则配置。系统预置了符合国家档案著录规则的检查模板，包括《档案著录规则》DA/T 18-2022 版本的规则模板和早期 1999 版本的规则模板，用户可以选择应用预置模板，然后根据本单位的实际情况进行个性化调整。规则配置完成后可以保存为共享规则，供多个项目复用，也可以保存为项目级规则，仅在特定项目中使用。

检查结果的展示采用直观的可视化界面。结果页面分为摘要区和详情区两部分。摘要区显示总档案数、通过数、错误数、警告数，以及各类问题的分布统计，用户可以快速了解整体的数据质量状况。详情区以表格形式展示每一条发现的问题，包括档号、题名、问题类型、严重程度和问题描述，用户可以点击问题跳转到对应的数据进行修正。对于检查发现的问题，软件支持导出带标注的 Excel 报表，报表中会标记出存在问题的行，方便将检查结果反馈给著录人员进行修正。

### 2.4 数据清洗与标准化功能

在完成数据导入后，通常需要对数据进行进一步的清洗和标准化处理。OpenRefine 提供了丰富的数据处理功能，能够满足档案数据整理的各种需求。列操作功能允许用户添加新列、删除不需要的列、重命名列名、调整列顺序，这些操作对于将数据整理成符合标准格式非常重要。行操作功能支持基于条件过滤、删除不需要的行，档案工作者可以使用这个功能筛选出需要重点关注的数据子集进行处理。

单元格编辑功能支持单个修改和批量修改两种模式。对于零散的著录错误，可以双击单元格直接编辑修改。对于批量存在相同错误的数据，可以使用批量替换功能一次性修正所有错误。批量替换支持普通字符串替换和正则表达式替换两种方式，正则表达式替换适用于处理有一定规律的格式错误，例如将"2000/01/01"格式的日期统一转换为"2000-01-01"格式。

表达式语言是 OpenRefine 数据处理功能的核心，它使软件具备了处理复杂数据转换的能力。表达式语言采用类 JavaScript 的语法，对于有编程基础的用户来说非常容易上手，对于没有编程基础的用户，软件也提供了常用的函数模板可以套用。表达式语言支持多种类型的函数：数学函数用于数值的计算和修约；字符串函数用于文本的截取、替换、大小写转换等操作；日期函数用于日期的解析、格式化和计算；条件函数用于根据条件设置不同的值。利用表达式语言，档案工作者可以完成各种复杂的数据标准化任务。

分面功能是 OpenRefine 最强大的数据探索工具之一。通过分面，档案工作者可以从不同角度快速了解数据的分布情况，识别需要处理的数据子集。文本分面显示某一列中各唯一值的出现频率，档案工作者可以使用这个功能快速了解档案类型、责任者、形成单位等字段的分布情况。数值分面以直方图形式显示数值字段的分布范围，可以帮助识别异常的数值。过滤功能与分面相配合，支持基于关键词的快速过滤和多条件的组合过滤，能够精确筛选出需要处理的数据。

### 2.5 数据导出与成果整理功能

完成数据整理和质量检查后，需要将处理结果导出以便后续利用或移交。OpenRefine 提供了多种数据导出格式的选择。CSV 和 TSV 格式是最通用的数据交换格式，几乎所有的档案管理系统都支持导入这两种格式的数据。Excel 格式适合生成便于人工查阅的目录文档，支持添加格式和样式使报表更加美观。自定义导出模板功能允许用户定义特殊的输出格式，满足不同系统的导入要求。SQL 格式导出可以直接生成 INSERT 语句，适合需要将数据导入到数据库的场景。

资源文件导出是档案整理工作的重要环节。OpenRefine 的资源导出功能支持批量导出数据绑定的电子文件，用户可以配置导出的目标路径规则，支持将多个字段的值拼接成文件路径。导出过程支持复制和移动两种操作模式，复制模式保留原始文件，移动模式将文件转移到目标位置后删除原文件。导出界面会实时显示进度和统计信息，包括成功导出的文件数、失败的次数和原因，以及跳过的文件数量。失败时会显示具体的错误原因，方便用户后续处理遗漏的文件。

导出带标注的 Excel 报表是质量检查结果反馈的重要方式。软件支持导出包含错误标记的 Excel 文件，报告中会标注每一条问题所在的位置和问题的详细描述，方便将检查结果反馈给著录人员进行修正。报表还可以选择导出统计汇总信息，包括各类问题的数量统计和分布情况，便于管理人员了解整体的数据质量状况。

## 三、使用场景指南

### 3.1 档案数字化成果整理

档案数字化是当前各级档案馆的重要工作之一，数字化扫描完成后会产生大量的电子文件，需要进行系统的整理才能纳入档案管理系统进行管理。OpenRefine 是数字化成果整理工作的理想工具，它能够帮助档案工作者完成从元数据整理到电子文件核对的全部工作。

数字化成果整理的标准工作流程如下：第一步，从数字化加工软件或档案管理系统导出元数据，通常为 Excel 或 CSV 格式的文件。第二步，使用 OpenRefine 导入元数据，如果数据存储在数据库中，可以使用 Records-DB 扩展直接连接数据库导入。第三步，使用数据清洗功能对元数据进行规范化处理，包括统一日期格式、修正明显的著录错误、去除多余的空白字符等。第四步，使用数据质量检查功能对元数据进行质量检查，发现格式错误、缺失字段等问题。第五步，根据检查结果修正发现的问题。第六步，使用 Records-Assets 扩展核对电子文件，检查文件是否存在、数量是否一致、命名是否规范。第七步，导出整理后的元数据电子文件。第八步，使用资源导出功能整理电子文件，按照要求的目录结构组织文件。

在整个流程中，OpenRefine 的各个功能模块相互配合，形成了完整的数字化成果整理解决方案。数据导入功能支持多种来源的数据获取，数据清洗功能处理各种数据质量问题，质量检查功能全面校验数据规范性，资源管理功能核对电子文件的一致性，导出功能输出符合要求的整理成果。每个步骤都可以独立进行，也可以根据实际需要跳过某些步骤，灵活适应不同的工作要求。

### 3.2 档案移交数据准备

档案移交是档案管理的重要业务环节，无论是馆藏档案向国家档案馆的移交，还是机关单位向档案馆的定期移交，都需要对移交档案的数据质量进行严格的检查。OpenRefine 的质量检查功能能够帮助移交方在移交前进行自查，发现并修正数据质量问题，也能够帮助接收方在接收时进行抽检，验证移交数据的质量状况。

移交方使用 OpenRefine 进行数据准备的工作流程如下：首先，将待移交档案的数据导出为标准格式的文件。然后，导入 OpenRefine 进行质量检查。检查项目包括：档号的唯一性检查，确保没有重复的档号；必填字段的非空检查，确保题名、责任者、时间等重要字段都有著录；日期格式的规范化检查，确保日期格式统一；文件资源的存在性检查，确保每份档案都有对应的电子文件。

对于检查发现的问题，软件支持导出详细的检查报告，报告中标注了存在问题的档案档号、问题类型和问题描述。著录人员根据报告修正问题后，可以再次运行检查，直到所有问题都得到解决。检查通过后，移交方可以导出最终的移交数据清单，连同电子档案一起打包提交给接收方。

接收方收到移交数据后，可以使用 OpenRefine 进行质量抽检。抽检可以采用随机抽样或按特定条件筛选的方式，检查样本数据是否符合移交标准。抽检结果可以作为接收决策的参考依据，对于发现的问题可以形成问题清单反馈给移交方要求整改。这种标准化的移交检查流程有助于提高移交数据的整体质量，减少后续的返工工作量。

### 3.3 馆藏档案数据核查

馆藏档案经过长期的积累，往往存在数据质量参差不齐的问题。一些历史档案的著录信息可能不完整、不规范，电子档案与目录数据之间也可能存在不一致的情况。定期对馆藏档案数据进行质量核查，是档案馆保证数据质量的重要工作。OpenRefine 提供了全面的数据质量检查能力，是馆藏档案数据核查的理想工具。

馆藏数据核查可以从以下几个方面开展：第一，完整性核查。检查必填字段是否有缺失，特别是题名、责任者、时间等核心著录项目。对于缺失重要字段的档案记录，需要补充完善著录信息。第二，规范性核查。检查各类字段的格式是否符合规范，包括日期格式、档号格式、文号格式等。对于格式不规范的记录，需要进行标准化处理。第三，一致性核查。检查档案目录与电子文件之间的一致性，包括文件是否存在、数量是否匹配、命名是否规范等。对于不一致的情况，需要核实原因并进行处理。第四，重复性核查。检查是否存在重复的档案记录，对于确认重复的记录需要进行合并或删除处理。

OpenRefine 的分面和过滤功能在数据核查工作中非常有用。通过文本分面可以快速发现著录信息异常的记录，例如某列中出现频率极低的值可能表示存在输入错误。通过数值分面可以发现超出合理范围的数值，例如年度字段出现未来的年份。通过组合过滤可以筛选出需要重点关注的数据子集进行详细检查。这种可视化的数据探索方式比传统的逐条检查高效得多。

### 3.4 档案数据迁移与格式转换

档案管理信息系统升级换代时，通常需要进行档案数据的迁移。不同系统之间的数据格式和结构往往存在差异，需要进行格式转换才能导入到新系统中。OpenRefine 的数据处理功能能够很好地支持数据迁移工作，它可以对数据进行清洗、转换和标准化，使数据符合目标系统的导入要求。

数据迁移工作的典型流程如下：首先，从旧系统导出数据，这可能是 CSV、Excel 或数据库导出文件等形式。然后，将数据导入 OpenRefine 进行处理。接下来，根据目标系统的数据结构要求，对字段进行重命名、拆分或合并。然后，使用表达式对数据进行标准化处理，包括日期格式统一、文本规范化等。然后，检查数据中是否存在错误或异常，进行必要的修正。最后，导出符合目标系统要求格式的数据，进行试导入验证。

OpenRefine 在数据迁移中的优势在于其操作的可追溯性。每一步数据转换都被记录在操作历史中，如果迁移后发现问题，可以快速定位问题原因并进行修正。操作历史也可以作为迁移过程的文档留存，满足档案工作对过程记录的要求。

## 四、技术架构说明

### 4.1 系统架构

OpenRefine 采用前后端分离的架构设计。后端使用 Java 语言开发，基于 Jetty 轻量级 Web 服务器，提供 RESTful API 接口处理业务逻辑。前端使用 JavaScript 开发单页应用，通过 AJAX 技术与后端 API 通信。这种架构使得系统具有良好的扩展性和可维护性，同时也方便与其他系统进行集成。

后端核心模块包括项目管理系统、数据处理引擎、表达式解析器、导入导出模块等。项目管理系统负责项目的创建、存储、加载和删除，每个项目的数据和元数据以压缩格式存储在工作目录中。数据处理引擎实现了各种数据操作功能，包括列操作、行操作、单元格编辑等。表达式解析器负责解析和执行用户编写的 GREL 表达式。导入导出模块处理各种格式的数据读写，支持扩展模块注册新的导入器和导出器。

前端界面基于 jQuery 框架构建，使用自定义的 UI 组件。界面采用多面板布局，包括数据视图面板、分面过滤面板、历史记录面板等。所有的数据操作都通过 AJAX 调用后端 API 完成，前端负责界面的渲染和用户交互的响应。前端代码模块化组织，核心功能与扩展功能分离，便于维护和扩展。

### 4.2 扩展模块架构

OpenRefine 提供了完善的扩展机制，允许通过开发扩展模块来添加新功能。档案行业专用的三个扩展模块都遵循标准的扩展开发规范。扩展模块与核心功能分离，核心功能提供基础的平台能力，扩展模块在此基础上增加专业功能。这种架构使得系统既有统一的基础体验，又有灵活的专业扩展能力。

Records-DB 扩展实现了档案数据库导入的全部功能，包括数据库连接管理、Schema Profile 配置、数据查询执行、项目创建等。扩展采用流式处理技术处理大数据量导入，性能表现优异。Records-Assets 扩展实现了档案资源管理的全部功能，包括目录浏览、文件预览、安全验证等。扩展实现了按需加载机制，确保处理大量文件时界面仍然流畅。Data-Quality 扩展实现了数据质量检查的全部功能，包括规则配置、检查执行、结果展示等。扩展支持断点续跑机制，大批量数据检查时可以分批进行，避免一次性处理过多数据导致的性能问题。

### 4.3 数据存储机制

OpenRefine 项目的本地存储采用专有的压缩格式。每个项目对应工作目录下的一个文件夹，包含 data.zip 文件（存储项目数据）和 metadata.json 文件（存储项目元数据）。data.zip 内部采用列式存储格式，支持高效的数据访问和随机定位。metadata.json 记录了项目的配置信息，如列定义、历史记录等信息。

历史记录是 OpenRefine 的重要特性。每个操作都会生成一个历史条目，记录操作的类型、参数和影响范围。用户可以随时查看历史记录，选择撤销任意数量的操作。历史记录与项目数据分开存储，确保历史记录的加载不会影响正常的项目操作。大量历史操作可能会占用较多存储空间，用户可以选择压缩历史来节省空间。

扩展模块可以声明自己的 overlay model 来存储额外的数据。overlay model 与主项目数据分离，但会随项目一起保存和加载。例如，Records-DB 扩展使用 overlay model 存储数据源配置、Schema Profile 设置等信息，使得这些配置能够永久保存到项目中，下次打开项目时自动恢复。这种机制使得扩展能够无缝集成到 OpenRefine 的项目管理体系中。

### 4.4 安全机制

档案数据的安全性是 OpenRefine 设计的首要考量。软件采用纯本地化运行的架构，所有数据处理都在用户自己的计算机上完成，不需要将数据传输到任何外部服务器。这种架构从技术上保障了档案数据的安全性，使得软件可以安全地应用于涉密档案数据的整理工作。

在资源访问控制方面，Records-Assets 扩展实现了严格的安全机制。用户需要预先配置允许访问的资源根目录，所有文件访问请求都会经过路径验证，确保访问范围不超出授权目录。扩展实现了路径规范化处理，防止目录遍历攻击。这种白名单机制从技术上防止了越权访问和数据泄露的风险。

数据隔离机制确保不同项目的数据相互独立。每个项目的数据存储在独立的文件夹中，项目的导入导出操作都在各自的数据范围内进行。软件没有提供跨项目批量操作的功能，避免了误操作导致的多项目数据影响。这种隔离机制使得用户可以放心地在同一台计算机上处理多个不同的档案项目。

## 五、运行环境与安装

### 5.1 系统要求

OpenRefine 对运行环境有一定的要求，确保软件能够稳定运行并发挥最佳性能。在操作系统方面，软件支持 Windows 10 及以上版本、macOS 10.15 (Catalina) 及以上版本，以及主流的 Linux 发行版。不同操作系统的安装包不同，但功能完全一致，用户可以根据自己的操作系统选择对应的版本。

在 Java 运行环境方面，OpenRefine 需要 JDK 11 或更高版本。建议使用 Eclipse Temurin (原 AdoptOpenJDK) 或其他 OpenJDK 发行版。软件不依赖特定的商业 JDK，开源的 OpenJDK 完全能够满足需求。运行前需要确保 JAVA_HOME 环境变量正确配置为 JDK 的安装路径。可以通过在命令行运行 java -version 来验证 Java 环境是否正确安装。

内存需求取决于处理的数据量。对于几千行到几万行的中等规模档案数据，2GB 内存通常足够。处理几十万行的大型馆藏数据时，建议分配 4GB 或更多内存。OpenRefine 可以在启动参数中配置 JVM 堆内存大小，通过 -m 参数指定最大内存，例如 -m 4096M 表示最大使用 4GB 内存。

### 5.2 安装步骤

Windows 系统的安装步骤如下：首先，从 OpenRefine 官方网站下载 Windows 安装程序（.exe 文件）或压缩包（.zip 文件）。如果下载的是安装程序，双击运行安装程序，按照安装向导的提示完成安装。如果下载的是压缩包，将文件解压到指定目录即可使用。安装完成后，双击 refine.bat 启动 OpenRefine，启动后浏览器会自动打开管理界面。

macOS 系统的安装步骤如下：从官方网站下载 macOS 镜像文件（.dmg 文件）或压缩包（.zip 文件）。如果下载的是镜像文件，双击打开后将 OpenRefine 应用程序拖动到应用程序文件夹即可。如果下载的是压缩包，将文件解压后得到 OpenRefine 应用，将其移动到应用程序文件夹或任意目录。双击 OpenRefine 应用启动软件。

Linux 系统的安装步骤如下：从官方网站下载压缩包（.tar.gz 文件）。在命令行中使用 tar 命令解压文件：tar xzf openrefine-*.tar.gz。解压后会得到一个目录，进入该目录运行 ./refine 启动 OpenRefine。也可以将 OpenRefine 添加到系统菜单或桌面快捷方式方便后续启动。

### 5.3 扩展模块启用

档案行业专用的三个扩展模块需要单独安装和启用。对于预编译的发行版，需要从项目的 GitHub  releases 页面下载扩展模块的发行包，将扩展文件复制到 OpenRefine 安装目录的 webapp/extensions 文件夹中。具体操作步骤请参考扩展模块的 README 文档。

对于从源码编译运行的用户，扩展模块默认包含在构建中。需要在配置文件中启用相应的扩展模块。配置文件通常位于工作目录或安装目录下，编辑配置文件添加扩展模块的启用选项。具体配置方法请参考扩展模块的文档。

扩展模块启用后，需要重启 OpenRefine 才能生效。重启后，在创建项目页面会看到新增的导入选项，在项目界面会看到新增的功能菜单。可以通过查看扩展模块的文档确认功能是否正常启用。

## 六、快速入门指南

### 6.1 首次启动

完成安装后，首次启动 OpenRefine 会看到欢迎界面。软件启动后会将工作目录设置为用户文档目录下的 OpenRefine Workspace 子目录，所有项目文件都会保存在这个目录下。用户也可以在启动时通过参数指定其他目录作为工作目录。

启动成功后，浏览器会自动打开一个新标签页，地址为 http://127.0.0.1:33333。这个地址是 OpenRefine 的本地访问地址，数据不会发送到互联网。如果浏览器没有自动打开，用户可以手动输入这个地址访问 OpenRefine 界面。界面的主要功能区包括：左侧的项目列表区、创建项目区，右侧的功能说明区。

在开始使用前，建议先熟悉界面的基本布局。项目列表区显示已创建的项目，点击项目名称可以打开项目进行编辑。创建项目区提供多种创建新项目的方式，包括从本机文件创建、从 URL 创建、从剪贴板创建等。对于档案数据库导入，需要确保已启用 Records-DB 扩展。

### 6.2 创建档案数据库项目

要从档案数据库导入数据，首先确保已启用 Records-DB 扩展。创建项目的第一步是选择"从档案数据库导入"选项，这会在右侧显示数据库连接配置界面。在配置界面中，用户需要选择数据库类型（MySQL、PostgreSQL、SQLite 等），填写数据库主机地址、端口、数据库名称、用户名和密码。连接参数填写完成后，可以点击"测试连接"按钮验证连接是否成功。

连接成功后，下一步是选择 Schema Profile。Profile 定义了要导入的数据结构，预置了库宝、平表、通用 JSON 三种模板。用户可以根据实际数据情况选择合适的模板，或者创建自定义 Profile。选择 Profile 后，软件会显示字段列表，用户可以勾选需要导入的字段，调整字段的顺序和名称。

如果需要过滤导入的数据，可以使用过滤构建器配置过滤条件。过滤条件支持多条件组合，每个条件可以指定字段、操作符和值。配置完成后，点击"预览"按钮查看预览数据，预览会显示前 100 行符合条件的数据。预览确认无误后，点击"创建项目"按钮开始导入数据。导入完成后会自动打开项目，进入数据整理界面。

### 6.3 数据质量检查操作

在项目界面中，可以通过"数据质量"菜单访问质量检查功能。首次使用需要先编辑质量规则。点击"编辑质量规则"菜单项，会在右侧面板显示规则编辑器。编辑器分为三个标签页：数据格式检查、文件资源关联检查、内容比对检查。用户可以在各个标签页中配置相应的检查规则。

数据格式检查标签页用于配置列级别的格式检查规则。首先需要选择要检查的列，然后选择检查类型（唯一性、非空、值域、日期格式、正则匹配），最后配置具体的检查参数。例如，要检查档号是否唯一，选择档号列，检查类型选择"唯一性"即可。配置完成后，点击"添加检查规则"按钮保存规则。

文件资源关联检查标签页用于配置电子文件关联性检查。首先需要选择路径列（存储文件路径的列），然后配置检查项目：文件存在性检查会验证路径是否指向真实存在的文件；文件数量检查需要指定页数列并核对文件数量；命名规范检查需要配置正则表达式验证文件名格式；序号连续性检查会验证文件夹或文件名中的序号是否连续。

规则配置完成后，可以保存规则供以后复用。点击"保存规则"按钮，选择保存为项目级规则或共享规则。保存完成后，可以点击"立即检查"菜单项运行检查。检查执行过程中会显示进度条，检查完成后显示检查结果。结果页面分为摘要区和详情区，摘要区显示总体统计信息，详情区显示具体的问题列表。

### 6.4 导出整理成果

完成数据整理和质量检查后，需要将成果导出以供后续利用。数据导出可以通过"导出"菜单访问。菜单提供了多种导出格式选项，包括 CSV、TSV、Excel、Excel 2007+ 等。对于档案目录导出，推荐使用 Excel 格式，导出的文件可以直接用于查看或提交。

导出选项中可以配置导出的列、导出文件的位置等。如果只需要导出部分数据，可以先使用分面或过滤功能筛选出目标数据，然后点击"导出"菜单中的"选定行"选项，只导出筛选后的数据。

资源文件的导出需要通过"导出数据绑定资源"功能。这个功能会导出与项目数据关联的电子文件。导出前需要配置目标路径规则，支持使用表达式从数据列构建路径。配置完成后，点击"执行导出"按钮开始导出文件。导出过程会显示进度条和统计信息，包括成功、失败、跳过的文件数量。

## 七、常见问题解答

### 7.1 安装与配置问题

问：启动 OpenRefine 时提示 Java 版本不兼容怎么办？答：首先确认系统中安装的 Java 版本。打开命令行，运行 java -version 查看当前 Java 版本。如果版本低于 11，需要安装 JDK 11 或更高版本。如果系统中安装了多个 Java 版本，可能需要设置 JAVA_HOME 环境变量指向正确的 JDK 安装路径。

问：OpenRefine 启动后浏览器打不开怎么办？答：首先确认 OpenRefine 确实已经启动，查看命令行输出是否有错误信息。然后手动在浏览器地址栏输入 http://127.0.0.1:33333 访问。如果还是打不开，可能是防火墙阻止了连接，可以检查 Windows 防火墙设置，允许 OpenRefine 的端口访问。

问：如何配置更大的内存来处理大量数据？答：可以通过启动参数增加 OpenRefine 的内存限制。在 refine.bat (Windows) 或 ./refine (Linux/macOS) 启动脚本中，修改 -m 参数的值。默认通常是 -m 1024M (1GB)，可以修改为 -m 4096M (4GB) 或更大值。修改后需要重启 OpenRefine 才能生效。

### 7.2 数据库连接问题

问：连接数据库时提示连接失败怎么办？答：首先确认数据库服务正在运行，网络连接正常。然后检查连接参数是否正确，包括主机地址、端口、数据库名、用户名和密码。对于某些数据库，还需要确认 JDBC 驱动是否正确安装。如果使用了特殊字符的密码，可能需要进行转义。如果问题仍然存在，查看 OpenRefine 的日志文件获取详细的错误信息。

问：如何保存数据库连接配置以便复用？答：在 Records-DB 扩展的连接配置界面中，填写完连接参数后，点击"保存配置"按钮。系统会提示输入配置名称，保存后该配置会出现在配置列表中，下次使用时可以直接选择已保存的配置，无需重新输入连接参数。

问：导入大量数据时速度很慢怎么办？答：确保数据库服务器性能良好，网络连接稳定。在导入配置中可以调整批次大小参数，适当增大批次大小可以提高导入速度。如果内存不足，可以增加 OpenRefine 的内存限制。也可以考虑先在数据库端进行数据筛选，只导入需要的数据，减少导入量。

### 7.3 质量检查问题

问：如何创建符合本单位著录规则的质量检查规则？答：首先了解本单位的著录规范要求，然后根据规范在规则编辑器中配置相应的检查规则。系统预置的规则模板可以作为参考，用户可以在模板基础上进行修改。如果需要检查的规则比较复杂，可以分步配置多个简单规则，组合实现复杂的检查逻辑。

问：内容比对功能需要连接外部服务，如何配置？答：Data-Quality 扩展的内容比对功能需要连接 Jinshu-aimp 信息抽取服务。在扩展配置中填写服务的地址（默认为 http://127.0.0.1:7998），确保 OpenRefine 能够访问该服务地址。如果服务在同一台机器上运行，确保服务已启动；如果在网络上，需要确认网络连接正常。

问：如何导出质量检查结果给著录人员修正？答：在检查结果页面，点击"导出报告"按钮，选择导出格式为 Excel。导出的 Excel 文件中会标记存在问题的行，包含档号、问题列、问题类型和问题描述。将这个文件发送给著录人员，著录人员根据报告修正问题后，可以重新导入进行复查。

### 7.4 资源管理问题

问：资源文件预览时图片加载很慢怎么办？答：资源预览采用按需加载机制，首次点击预览时才会加载文件。如果文件较大，可以等待加载完成。对于大量文件预览的场景，建议使用分页功能分批浏览。如果图片经常需要查看，可以考虑使用专门的图片查看软件。

问：如何配置允许访问的资源目录？答：Records-Assets 扩展的安全配置通过配置文件进行。在扩展的配置文件中添加 allowedRoots 配置项，指定允许访问的根目录路径。配置修改后需要重启 OpenRefine 才能生效。出于安全考虑，不要将允许访问的路径设置为系统根目录。

问：导出资源文件时部分文件导出失败怎么办？答：导出失败的错误原因会显示在导出统计信息中。常见的原因包括：文件路径不存在（文件可能被移动或删除）、文件被其他程序占用无法访问、文件权限不足等。根据错误提示处理相应的问题后，可以重新运行导出任务，软件会跳过已成功的文件，只导出失败的文件。

## 八、技术支持

### 8.1 官方资源

OpenRefine 官方网站 https://openrefine.org/ 提供了软件的下载链接、文档和使用指南。官方文档位于 https://openrefine.org/docs/，包含了详细的功能说明和操作指南。对于常见问题，GitHub 仓库的 Wiki 页面提供了大量有用的信息。

档案行业扩展模块的详细文档请参考项目 GitHub 仓库的 docs 目录。那里包含了扩展模块的设计文档、开发文档和使用指南。如果在使用过程中遇到问题，可以先查阅文档看是否已有解决方案。

### 8.2 社区支持

OpenRefine 拥有活跃的用户社区。用户可以在 GitHub 仓库提交问题报告或功能建议。发帖时提供详细的问题描述、软件版本、操作系统信息，以及问题发生前后的操作步骤，有助于他人理解问题并提供帮助。

对于档案行业用户的特殊需求和问题，建议在问题描述中详细说明业务场景和使用需求，这样社区贡献者能够更好地理解问题并提供针对性的帮助。社区的反馈对于软件的持续改进非常重要，欢迎用户积极反馈使用中的问题和建议。

*文档版本：1.0*
*最后更新：2025年12月*
*适用版本：OpenRefine 3.x*
